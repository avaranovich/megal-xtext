<html>
<head>
<title>MegaL Network Graph</title>
<link href="./vis/4.18.1/4.18.1/vis.min.css" rel="stylesheet" type="text/css">
<link href="./style.css" rel="stylesheet" type="text/css">
<script type="text/javascript" src="./vis/4.18.1/vis.min.js"></script>
</head>
<body>
	<div id="mynetwork">
		<div class="vis-network"
			style="position: relative; overflow: hidden; -moz-user-select: none; width: 100%; height: 100%;"
			tabindex="900">
			<canvas
				style="position: relative; -moz-user-select: none; width: 100%; height: 100%;"
				width="100%" height="100%"></canvas>
		</div>
	</div>
	<script type="text/javascript">
		var nodes = [ {
			id : "0",
			label : "0",
			group : 'source'
		}, {
			id : 1,
			label : "1",
			group : 'icons'
		}, {
			id : 2,
			label : "2",
			group : 'icons'
		}, {
			id : 3,
			label : "3",
			group : 'icons'
		}, {
			id : 4,
			label : "4",
			group : 'icons'
		}, {
			id : 5,
			label : "5",
			group : 'icons'
		}, {
			id : 6,
			label : "6",
			group : 'icons'
		}, {
			id : 7,
			label : "7",
			group : 'icons'
		}, {
			id : 8,
			label : "8",
			group : 'icons'
		}, {
			id : 9,
			label : "9",
			group : 'icons'
		}, {
			id : 10,
			label : "10",
			group : 'mints'
		}, {
			id : 11,
			label : "11",
			group : 'mints'
		}, {
			id : 12,
			label : "12",
			group : 'mints'
		}, {
			id : 13,
			label : "13",
			group : 'mints'
		}, {
			id : 14,
			label : "14",
			group : 'mints'
		}, {
			id : 15,
			group : 'dotsWithLabel'
		}, {
			id : 16,
			group : 'dotsWithLabel'
		}, {
			id : 17,
			group : 'dotsWithLabel'
		}, {
			id : 18,
			group : 'dotsWithLabel'
		}, {
			id : 19,
			group : 'dotsWithLabel'
		}, {
			id : 20,
			label : "diamonds",
			group : 'diamonds'
		}, {
			id : 21,
			label : "diamonds",
			group : 'diamonds'
		}, {
			id : 22,
			label : "diamonds",
			group : 'diamonds'
		}, {
			id : 23,
			label : "diamonds",
			group : 'diamonds'
		}, ];
		var edges = [ {
			from : 1,
			to : 0
		}, {
			from : 2,
			to : 0
		}, {
			from : 4,
			to : 3
		}, {
			from : 5,
			to : 4
		}, {
			from : 4,
			to : 0
		}, {
			from : 7,
			to : 6
		}, {
			from : 8,
			to : 7
		}, {
			from : 7,
			to : 0
		}, {
			from : 10,
			to : 9
		}, {
			from : 11,
			to : 10
		}, {
			from : 10,
			to : 4
		}, {
			from : 13,
			to : 12
		}, {
			from : 14,
			to : 13
		}, {
			from : 13,
			to : 0
		}, {
			from : 16,
			to : 15
		}, {
			from : 17,
			to : 15
		}, {
			from : 15,
			to : 10
		}, {
			from : 19,
			to : 18
		}, {
			from : 20,
			to : 19
		}, {
			from : 19,
			to : 4
		}, {
			from : 22,
			to : 21
		}, {
			from : 23,
			to : 22
		}, {
			from : 23,
			to : 0
		}, ]

		nodes = [];
		edges = [];
		
		var megamodel = JSON.parse(getJSONMegamodel());
		/*
		{
				entities : [ {
					id: "lala",
					name: "foo",
					group: "entities"
				}],
				relationships : []
		};
		*/
		
		var i;
		
		/*
		for (i in megamodel.entities) {
			
			var entity = megamodel.entities[i];
			var id = entity.name;
			var label = id.substr(id.lastIndexOf(".")+1);
			
			if (entity.type == "Language") {
			
				nodes.push({
					id: id,
					label: label,
					group: "entities"
				});
			
			}
			
		}
		*/
		
		for (i in megamodel.entityTypes) {
			
			var entity = megamodel.entityTypes[i];
			var id = entity.name;
			var label = id.substr(id.lastIndexOf(".")+1);
			
			nodes.push({
				id: id,
				label: label,
				group: "entities"
			});
			
		}
		
		/*
		for (i in megamodel.relationships) {
			var rel = megamodel.relationships[i];
			edges.push({
				from: rel.left,
				to: rel.right,
				label: rel.name
			});
		}
		*/
		
		for (i in megamodel.relationshipTypes) {
			var rel = megamodel.relationshipTypes[i];
			edges.push({
				from: rel.left,
				to: rel.right,
				label: rel.name
			});
		}
		
		// create a network
		var container = document.getElementById('mynetwork');
		var data = {
			nodes : nodes,
			edges : edges
		};
		var options = {
			physics:{
				enabled: false,
			    stabilization: false
			},
			layout: {
                hierarchical: {
                	levelSeparation: 500,
                	nodeSpacing: 500,
                    direction: "UD",
                    randomSeed:2,
                   // sortMethod: "directed",
                    edgeMinimization: false
                }
            },
			nodes : {
				shape : 'dot',
				size : 20,
				font : {
					size : 15,
					color : '#ffffff'
				},
				borderWidth : 2
			},
			edges : {
				width : 1,
				font : {
					size : 15,
					color : '#ffffff'
				},
				arrows:'to'
			},
			groups : {
				entities : {
					color : {
						background : 'cyan',
						border : 'cyan'
					},
					shape : 'diamond'
				},
				dotsWithLabel : {
					label : "I'm a dot!",
					shape : 'dot',
					color : 'cyan'
				},
				mints : {
					color : 'rgb(0,255,140)'
				},
				icons : {
					shape : 'icon',
					icon : {
						face : 'FontAwesome',
						code : '\uf0c0',
						size : 50,
						color : 'orange'
					}
				},
				source : {
					color : {
						border : 'white'
					}
				}
			}
		};
		var network = new vis.Network(container, data, options);
	</script>


</body>
</html>